<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="Description" content="Generated with HtmlAnim">
<title>HtmlAnim example 5 - Macros, context saving, translation, rotation and scaling</title>
</head>
<style type='text/css'>body{background-color:#f2f2f2;color:#000000;font-family:sans-serif;font-size:medium;font-weight:normal;}</style>
<body>
<h2>Example 5</h2>
<canvas id='anim_canvas_1' width='400' height='300'></canvas>
<script>
<!--
var frame_counter = 0;
const num_frames = 60;
var canvas = document.getElementById('anim_canvas_1');
var no_clear = false;
var repeat_current_frame = false;
var expressions = {};

function rect(ctx, x, y, w, h, fill) {
	ctx.beginPath();
	ctx.rect(x, y, w, h);
	if(fill)
		ctx.fill();
	else
		ctx.stroke();
}

function arc(ctx, x, y, r, sa, ea, fill) {
	ctx.beginPath();
	ctx.arc(x, y, r, sa, ea);
	if(fill)
		ctx.fill();
	else
		ctx.stroke();
}
function macro_smiley(ctx) {
ctx.lineWidth = 3;
arc(ctx, 0, 0, 80, 0.000000, 6.283185, false);
ctx.fillStyle = "yellow";
arc(ctx, 0, 0, 80, 0.000000, 6.283185, true);
ctx.fillStyle = "black";
arc(ctx, -30, -30, 10, 0.000000, 6.283185, true);
arc(ctx, 30, -30, 10, 0.000000, 6.283185, true);
arc(ctx, 0, 0, 50, 0, 3.141593, false);
}
function draw_bkgnd(ctx) {
ctx.save();
ctx.fillStyle = "white";
rect(ctx, 0, 0, 400, 300, true);
ctx.restore();
}

function draw_frgnd(ctx) {
}

frames = [
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.000000);
ctx.scale(1.000000, 1.500000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.104720);
ctx.scale(1.052264, 1.497261);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.209440);
ctx.scale(1.103956, 1.489074);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.314159);
ctx.scale(1.154508, 1.475528);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.418879);
ctx.scale(1.203368, 1.456773);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.523599);
ctx.scale(1.250000, 1.433013);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.628319);
ctx.scale(1.293893, 1.404508);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.733038);
ctx.scale(1.334565, 1.371572);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.837758);
ctx.scale(1.371572, 1.334565);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(0.942478);
ctx.scale(1.404508, 1.293893);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.047198);
ctx.scale(1.433013, 1.250000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.151917);
ctx.scale(1.456773, 1.203368);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.256637);
ctx.scale(1.475528, 1.154508);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.361357);
ctx.scale(1.489074, 1.103956);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.466077);
ctx.scale(1.497261, 1.052264);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.570796);
ctx.scale(1.500000, 1.000000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.675516);
ctx.scale(1.497261, 0.947736);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.780236);
ctx.scale(1.489074, 0.896044);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.884956);
ctx.scale(1.475528, 0.845492);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(1.989675);
ctx.scale(1.456773, 0.796632);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.094395);
ctx.scale(1.433013, 0.750000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.199115);
ctx.scale(1.404508, 0.706107);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.303835);
ctx.scale(1.371572, 0.665435);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.408554);
ctx.scale(1.334565, 0.628428);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.513274);
ctx.scale(1.293893, 0.595492);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.617994);
ctx.scale(1.250000, 0.566987);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.722714);
ctx.scale(1.203368, 0.543227);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.827433);
ctx.scale(1.154508, 0.524472);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(2.932153);
ctx.scale(1.103956, 0.510926);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.036873);
ctx.scale(1.052264, 0.502739);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.141593);
ctx.scale(1.000000, 0.500000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.246312);
ctx.scale(0.947736, 0.502739);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.351032);
ctx.scale(0.896044, 0.510926);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.455752);
ctx.scale(0.845492, 0.524472);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.560472);
ctx.scale(0.796632, 0.543227);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.665191);
ctx.scale(0.750000, 0.566987);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.769911);
ctx.scale(0.706107, 0.595492);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.874631);
ctx.scale(0.665435, 0.628428);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(3.979351);
ctx.scale(0.628428, 0.665435);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.084070);
ctx.scale(0.595492, 0.706107);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.188790);
ctx.scale(0.566987, 0.750000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.293510);
ctx.scale(0.543227, 0.796632);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.398230);
ctx.scale(0.524472, 0.845492);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.502949);
ctx.scale(0.510926, 0.896044);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.607669);
ctx.scale(0.502739, 0.947736);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.712389);
ctx.scale(0.500000, 1.000000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.817109);
ctx.scale(0.502739, 1.052264);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(4.921828);
ctx.scale(0.510926, 1.103956);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.026548);
ctx.scale(0.524472, 1.154508);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.131268);
ctx.scale(0.543227, 1.203368);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.235988);
ctx.scale(0.566987, 1.250000);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.340708);
ctx.scale(0.595492, 1.293893);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.445427);
ctx.scale(0.628428, 1.334565);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.550147);
ctx.scale(0.665435, 1.371572);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.654867);
ctx.scale(0.706107, 1.404508);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.759587);
ctx.scale(0.750000, 1.433013);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.864306);
ctx.scale(0.796632, 1.456773);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(5.969026);
ctx.scale(0.845492, 1.475528);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(6.073746);
ctx.scale(0.896044, 1.489074);
macro_smiley(ctx);
ctx.restore();
}),
(function(ctx) {
ctx.save();
ctx.translate(200, 150);
ctx.rotate(6.178466);
ctx.scale(0.947736, 1.497261);
macro_smiley(ctx);
ctx.restore();
}),
];

window.onload = function() {
	ctx = canvas.getContext('2d'),
	(function drawFrame () {
		if(frame_counter == 0 || !no_clear)
			ctx.clearRect(0, 0, canvas.width, canvas.height);
		repeat_current_frame = false;
		draw_bkgnd(ctx);
		(frames[frame_counter])(ctx);
		draw_frgnd(ctx);
		if(!repeat_current_frame) {
			frame_counter = (frame_counter + 1) % num_frames;
			expressions = {};
		}
		window.requestAnimationFrame(drawFrame, canvas);
	}());
}

//-->
</script>
<noscript>JavaScript is required to display this content.</noscript>

<p>The animation above can be generated using this code:</p>
<p><pre>
#include "htmlanim.hpp"
int main() {
	HtmlAnim::HtmlAnim anim("HtmlAnim example 5 - Macros, context saving, translation, rotation and scaling", 400, 300);
	const auto n_frames = 60;
	const constexpr char* smiley = "smiley";
	anim.frame().define_macro(smiley)
		.line_width(3)
		.arc(0, 0, 80)
		.fill_style("yellow")
		.arc(0, 0, 80, true)
		.fill_style("black")
		.arc(-30, -30, 10, true)
		.arc(30, -30, 10, true)
		.arc(0, 0, 50, false, 0, M_PI);
	for(auto frame = 0; frame < n_frames; ++frame) {
		const auto rot = 2 * M_PI / n_frames * frame;
		anim.frame()
			.save()
			.translate(anim.get_width() / 2, anim.get_height() / 2)
			.rotate(rot)
			.scale(1 + 0.5 * sin(rot), 1 + 0.5 * cos(rot))
			.draw_macro(smiley);
		anim.next_frame();
	}
	anim.remove_last_frame();
	anim.write_file("trans_rot_scale.html");
}
</pre></p>
<hr>
<p>
<small><a href="index.html">Back to index</a></small><br>
<small>Github project: <a href="https://github.com/rkibria/HtmlAnim">https://github.com/rkibria/HtmlAnim</a></small>
</p>


</body>
</html>
